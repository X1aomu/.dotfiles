if !exists("g:os")
  if has("win64") || has("win32") || has("win16")
    let g:os = "Windows"
  else
    let g:os = substitute(system('uname'), '\n', '', '')
  endif
endif

let mapleader = "\<Space>"

"===== Section Start =====
" vim-plug               |
"=========================

if has("unix")
  if empty(glob('~/.vim/autoload/plug.vim'))
    silent !curl -fLo ~/.vim/autoload/plug.vim --create-dirs
    \ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
    autocmd VimEnter * PlugInstall --sync | source $MYVIMRC
  endif
endif

call plug#begin('~/.vim/plugged')
" colorthemes
Plug 'lifepillar/vim-solarized8'
Plug 'joshdick/onedark.vim'
Plug 'dracula/vim', { 'as': 'dracula' }
" editing
Plug 'editorconfig/editorconfig-vim'
Plug 'jiangmiao/auto-pairs'
Plug 'scrooloose/nerdcommenter'
Plug 'tpope/vim-surround'
" look
Plug 'itchyny/lightline.vim'
Plug 'luochen1990/rainbow'
let g:rainbow_active = 1
" lang
Plug 'sheerun/vim-polyglot' " A solid language pack for Vim.
Plug 'ambv/black', {'for': 'python'}
Plug '~/.vim/plugged/YouCompleteMe' " YCM isn't managed by vim-plug this way
let g:ycm_autoclose_preview_window_after_insertion = 1
let g:ycm_global_ycm_extra_conf = '~/.ycm_global_extra_conf.py'
let g:ycm_confirm_extra_conf = 0
" other
Plug 'tpope/vim-sensible'
Plug 'tpope/vim-obsession'
Plug 'junegunn/fzf'
Plug 'junegunn/fzf.vim'
call plug#end()

"====== Section End ======
" vim-plug               |
"=========================

map <C-K> :pyf /usr/share/clang/clang-format.py<cr>
imap <C-K><c-o> :pyf /usr/share/clang/clang-format.py<cr>

nnoremap <leader>jj :YcmCompleter GoTo<CR>
nnoremap <leader>jd :YcmCompleter GoToDeclaration<CR>
nnoremap <leader>jD :YcmCompleter GoToDefinition<CR>
nnoremap <leader>ji :YcmCompleter GoToInclude<CR>

inoremap jk <ESC>
set timeout
set ttimeout
set timeoutlen=300
set ttimeoutlen=10

" first of all
set nocompatible

" look
set ruler
set number
set showcmd
set laststatus=2

" searching
set hlsearch
set ignorecase smartcase
set incsearch
" navigation
set scrolloff=1
set backspace=indent,eol,start " allow backspacing over everything
set whichwrap=b,s,<,>,[,]
set wrap

" indent
set noautoindent
set smarttab

" misc
set history=1000
set modeline
set modelines=3
if g:os == "Linux"
  set clipboard=unnamed,exclude:cons\|linux
endif

" Enable true color
if exists('+termguicolors')
  let &t_8f = "\<Esc>[38;2;%lu;%lu;%lum"
  let &t_8b = "\<Esc>[48;2;%lu;%lu;%lum"
  set termguicolors
endif

" color scheme
syntax on
set background=light
let g:solarized_extra_hi_groups = 1
let g:solarized_termtrans = 1
let g:onedark_terminal_italics = 1
let g:dracula_colorterm = 0
let g:dracula_italic = 1
colorscheme dracula
let g:lightline = {
  \ 'colorscheme': 'dracula',
  \ }

if has('mouse')
  set mouse=a
endif

if has("vms")
  set nobackup		" do not keep a backup file, use versions instead
else
  set backup		" keep a backup file (restore to previous version)
  if has('persistent_undo')
    set undofile	" keep an undo file (undo changes after closing)
  endif
endif

" The matchit plugin makes the % command work better, but it is not backwards
" compatible.
" The ! means the package won't be loaded right away but when plugins are
" loaded during initialization.
if has('syntax') && has('eval')
  packadd! matchit
endif

if has("autocmd")
  " Put these in an autocmd group, so that we can delete them easily.
  augroup vimrcEx
    au!
    " When editing a file, always jump to the last known cursor position.
    " (happens when dropping a file on gvim).
    autocmd BufReadPost *
      \ if line("'\"") >= 1 && line("'\"") <= line("$") |
      \   exe "normal! g`\"" |
      \ endif
  augroup END " vimrcEx
endif " has("autocmd")

if has('langmap') && exists('+langnoremap')
  " Prevent that the langmap option applies to characters that result from a
  " mapping.  If unset (default), this may break plugins (but it's backward
  " compatible).
  set langnoremap
endif

set fileencodings=usc-bom,utf-8,default,gb18030,cp936,latin1
" vim: set et sts=2 sw=2 :
